<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Calculadora Edgar ðŸ§®</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #f5f5f5;
      margin: 0;
      transition: background-color 0.3s, color 0.3s;
    }

    .calculadora {
      background: #222;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.4);
      width: 320px;
      max-width: 90vw;
      box-sizing: border-box;
    }

    input {
      width: 100%;
      font-size: 2.2em;
      margin-bottom: 15px;
      text-align: right;
      padding: 15px;
      border: none;
      border-radius: 8px;
      color: #fff;
      background-color: #111;
      font-family: 'Courier New', monospace;
      box-sizing: border-box;
      outline: none;
    }

    .fila-botones {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    button {
      flex: 1;
      height: 60px;
      font-size: 1.5em;
      border: none;
      border-radius: 8px;
      background-color: #333;
      color: #fff;
      cursor: pointer;
      transition: background-color 0.2s, transform 0.1s;
      min-width: 0;
    }

    button:hover {
      background-color: #444;
    }

    button:active {
      transform: scale(0.95);
    }

    button.operador {
      background-color: orange;
    }

    button.operador:hover {
      background-color: #e69500;
    }

    button.borrar {
      background-color: #e53935;
    }

    button.borrar:hover {
      background-color: #d32f2f;
    }

    button.igual {
      background-color: #43a047;
      color: #fff;
      flex: 2;
    }

    button.igual:hover {
      background-color: #388e3c;
    }

    .volver, .tema {
      margin-top: 10px;
      background-color: #555;
      width: 100%;
      padding: 15px;
      font-size: 1em;
      border-radius: 8px;
      cursor: pointer;
      border: none;
      color: white;
      transition: background-color 0.3s, transform 0.1s;
    }

    .volver:hover, .tema:hover {
      background-color: #666;
    }

    .volver:active, .tema:active {
      transform: scale(0.97);
    }

    /* ðŸŒ— Modo claro */
    .modo-claro {
      background-color: #e6e6e6;
      color: #111;
    }

    .modo-claro .calculadora {
      background: #fff;
    }

    .modo-claro input {
      background-color: #f0f0f0;
      color: #000;
    }

    .modo-claro button {
      background-color: #ddd;
      color: #000;
    }

    .modo-claro button:hover {
      background-color: #ccc;
    }
  </style>
</head>
<body>
  <div class="calculadora">
    <input type="text" id="pantalla" disabled />

    <div class="fila-botones">
      <button class="borrar" onclick="borrar()">ðŸ’€</button>
      <button onclick="borrarTodo()">AC</button>
      <button onclick="agregar('(')">(</button>
      <button onclick="agregar(')')">)</button>
      <button class="operador" onclick="agregar('/')">/</button>
    </div>

    <div class="fila-botones">
      <button onclick="agregar('7')">7</button>
      <button onclick="agregar('8')">8</button>
      <button onclick="agregar('9')">9</button>
      <button class="operador" onclick="agregar('*')">Ã—</button>
    </div>

    <div class="fila-botones">
      <button onclick="agregar('4')">4</button>
      <button onclick="agregar('5')">5</button>
      <button onclick="agregar('6')">6</button>
      <button class="operador" onclick="agregar('-')">âˆ’</button>
    </div>

    <div class="fila-botones">
      <button onclick="agregar('1')">1</button>
      <button onclick="agregar('2')">2</button>
      <button onclick="agregar('3')">3</button>
      <button class="operador" onclick="agregar('+')">+</button>
    </div>

    <div class="fila-botones">
      <button onclick="agregar('0')">0</button>
      <button onclick="agregar('.')">.</button>
      <button onclick="porcentaje()">%</button>
      <button class="igual" onclick="operar()">=</button>
    </div>

    <button class="volver" onclick="volverLogin()">ðŸ”™ Volver al Login</button>
    <button class="tema" onclick="cambiarTema()">ðŸŒ— Cambiar tema</button>
  </div>

  <script>
    const pantalla = document.getElementById("pantalla");

    function agregar(valor) {
      pantalla.value += valor;
    }

    function borrar() {
      pantalla.value = pantalla.value.slice(0, -1);
    }

    function borrarTodo() {
      pantalla.value = '';
    }

    function operar() {
      try {
        pantalla.value = eval(pantalla.value);
      } catch {
        pantalla.value = "Error";
      }
    }

    // ðŸ§® CÃ¡lculo avanzado de porcentaje
    function porcentaje() {
      try {
        let expresion = pantalla.value;
        const operadores = ['+', '-', '*', '/'];

        for (let op of operadores) {
          let partes = expresion.split(op);
          if (partes.length === 2 && partes[1].includes('%')) {
            let base = parseFloat(partes[0]);
            let porcentaje = parseFloat(partes[1]);
            if (op === '+') pantalla.value = base + (base * porcentaje / 100);
            else if (op === '-') pantalla.value = base - (base * porcentaje / 100);
            else if (op === '*') pantalla.value = base * (porcentaje / 100);
            else if (op === '/') pantalla.value = base / (porcentaje / 100);
            return;
          }
        }

        // Si solo es un nÃºmero con %, divide entre 100
        if (expresion.includes('%')) {
          pantalla.value = parseFloat(expresion) / 100;
        } else {
          pantalla.value = eval(expresion) / 100;
        }

      } catch {
        pantalla.value = "Error";
      }
    }

    function volverLogin() {
      const confirmar = confirm("Â¿EstÃ¡s seguro de que quieres volver al login?");
      if (confirmar) {
        window.location.href = 'login.html';
      }
    }

    function cambiarTema() {
      document.body.classList.toggle("modo-claro");
      const temaActual = document.body.classList.contains("modo-claro") ? "claro" : "oscuro";
      localStorage.setItem("tema", temaActual);
    }

    window.onload = function () {
      const temaGuardado = localStorage.getItem("tema");
      if (temaGuardado === "claro") {
        document.body.classList.add("modo-claro");
      }
    };

    document.addEventListener("keydown", function (event) {
      if (event.key === "Enter") {
        operar();
      }
    });
  </script>
</body>
</html>
